p=lambda g:(b:=[*{*sum(a:=[[j for j in i if j]for i in g if sum(i)],[])}])and[[b[j==b[0]]for j in i]for i in a]