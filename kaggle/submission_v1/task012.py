p=lambda j,A=range(-2,3),c=enumerate,E=abs:(k:=[r[:]for r in j],[k[I+D].__setitem__(C+F,[B[C-1],H][X])for I,B in c(j)for C,H in c(B)if H and B[C-1]*B[C+1]for D in A for F in A if(X:=E(D)==E(F))or not D*F])and k